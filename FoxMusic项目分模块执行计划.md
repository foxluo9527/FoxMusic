# FoxMusic项目分模块执行计划

## 项目现状分析

* 项目采用模块化架构，包含core和feature两大模块群

* 使用Jetpack Compose作为UI框架

* 使用Hilt进行依赖注入

* 使用Kotlin Serialization和Room数据库

* 使用MVI架构模式

* 使用Material Design 3作为UI设计规范

* 所有列表使用Paging 3实现分页加载

* 当前主界面已基础实现，后续需完善修改主界面UI以及开发多个子界面

* 使用Fox Music API Documentation.md作为api文档

* 项目中所有需要上传文件的地方均需先使用/api/upload/xx 系列接口上传获得站内url，参考接口文档

* 项目中所有使用url的地方均需先判断是否是站内url（不以http或https开头），如果是站内url前需拼接baseUrl:http://39.106.30.151:9000 

* 项目上传图片选择后需使用uCrop进行裁剪

## 功能实现

### 主页-首页区域

1. **完善MusicList.kt**

   * 使其具备单项展开菜单BottomSheet弹窗，弹窗包含歌曲详情、歌手详情、专辑详情、添加到播放列表、添加到用户歌单、从歌单删除（仅在用户的歌单详情中展示）等功能

   * 使其具备多选功能，可以外部控制开始多选状态，多选状态下底部出现功能区：添加到播放列表、添加到用户歌单、从歌单删除（仅在用户的歌单详情中展示）、下载等功能
   
   * 组件可以控制是否具备多选功能，具备时顶部展示多选文字

   * 组件顶部展示：topLeft和topRight圆角，左侧播放按钮文案为播放全部（歌曲数量），右侧选择按钮，点击右侧进入多选状态，左侧播放变成全选，文案展示已选择数量/全部数量，右侧文案变成取消

2. **完善PlayerScreen.kt**

   * 使其以BottomSheet形式弹出，并且可以通过顶部控制块控制sheet的收起和展开

   * 使其现有页面内容作为横向pager的第一页，增加横向pager

   * pager第二页为歌词详情,通过点击第一页的中心区域（封面到歌词部分）跳转第二页，而第二页左上角展示返回按钮回到第一页
   
   * 第二页展示歌词列表，增加歌词控制进度，并且展示歌曲评论入口，入口展示两条评论，循环展示前十条评论

   * 增加玻璃模糊播放背景，增加音量调整功能

3. **HomeScreen功能完善**

   * 顶部展示多功能入口，包含排行榜，播放历史，下载管理，推荐歌手

   * 首页的MusicList控制不展示多选功能

4. **增加下载管理页**

   * 顶部展示选项卡，分别是Downloading、Downloaded

   * 底部展示横向pager跟随顶部选项卡联动

   * 使用第三方下载库实现下载功能
   
### 主页-探索模块

1. **完善分类页面**

   * 顶部展示选项卡，前两项分别是，New、Hot，其他项为歌单分类

   * 底部展示横向pager跟随顶部选项卡联动

   * 前两项获取new和hot的音乐展示列表，使用MusicList组件，此处组件具备多选功能
   
   * 其他项列表展示歌单列表，使用grid布局，展示3列

2. **Search模块迁移至单独页面**

   * 探索顶部展示搜索框，点击搜索框进入搜索页面

   * Search模块顶部展示搜索输入框，其下是切换选项卡，包含推荐搜索和搜索历史

   * 通过接口获取推荐搜索列表

   * 搜索结果的MusicList具备多选功能

### 主页-歌单模块

1. **完善歌单模块功能**

   * 顶部展示选项卡，分别是Recommend、Mine

   * 底部展示横向pager跟随顶部选项卡联动

   * 分别是Recommend项获取所有歌单展示列表，此处展示方式由你拟定，需要界面美观具备新意
   
   * Mine项列表展示用户创建的歌单，使用垂直列表展示

   * Mine项顶部展示：左侧歌单数量，右侧创建歌单按钮，点击创建弹出bottomSheet询问用户创建歌单或者导入网易云/QQ音乐歌单，创建时弹出输入框，输入歌单名称，导入则提示用户输入网易云/QQ音乐歌单链接
   
   * 用户歌单列表展示导入中状态
   
2. **完善歌单详情页**

   * 调整布局使其美观

   * 增加返回左侧按钮，若判断为用户创建的歌单右侧展示菜单，包含编辑项，点击编辑项菜单进入编辑歌单页面

   * 歌单详情页不仅展示歌单详情还同时展示排行榜、专辑
   
   * 详情页还需展示歌单简介，最多3行，歌单封面和简介在顶部与列表联动
   
   * 详情页MusicList展示歌单中的歌曲，具备多选功能

### 主页-我的模块

1. **完善我的模块界面功能**

   * 顶部展示用户基本信息，点击后进入详情，展示用户资料，可以更换用户头像，编辑昵称、签名等

   * 主区域展示用户的收藏，使用选项卡切换，包含收藏的歌曲、歌手、专辑
   
   * 顶部资料卡片右侧展示抽屉菜单按钮，点击展开抽屉菜单，展示用户操作项，包含设置、修改密码、退出登录、我的信息（点击进入信息页面，包含信息列表和好友列表两个选项卡）、社区入口等

2. **完善用户登录流程**

   * 增加忘记密码选项，增加忘记密码功能，流程参考接口文档：包含第一步获取邮箱验证码，第二步上传邮箱验证码和新密码

   * 实现个人设置管理

   * 实现用户数据统计

3. **实现feature:chat模块**

   * 增加信息页面，包含用户信息列表和好友列表两个选项卡，左侧返回按钮，右侧菜单包含添加好友、好友请求功能

   * 增加添加好友功能，流程参考接口文档：包含第一步搜索用户，第二步添加好友（包含查看用户资料，可以设置好友备注）

   * 增加聊天页面，左侧返回按钮，顶部中间展示好友昵称或备注，右侧更多进入聊天设置，可以设置聊天背景、字体大小、字体颜色、查看好友信息等
   
   * 增加用户资料页，展示好友资料，若是好友底部展示删除好友按钮，若不是好友底部展示添加好友按钮，若是自己则展示编辑资料按钮

   * 聊天页面包含发送消息输入框，发送按钮，接收消息展示区域，展示好友发送的消息，包含消息时间、好友昵称或备注、消息内容，底部输入框若没有输入展示更多按钮，若有输入展示发送按钮
   
   * 发送更多按钮点击后底部展示更多发送功能区，包含发送图片、发送文件、拍照摄像等，发送图片文件等需要压缩后上传

4. **实现feature:social模块**

   * 增加社区页面，包含帖子列表和发布帖子功能

   * 增加帖子详情页，展示帖子内容、评论列表、点赞数、评论数、发布评论等

   * 增加发布帖子功能，流程参考接口文档：包含第一步上传图片，第二步上传帖子内容，包含图片url（若有上传）和帖子内容

## 预期成果

* 完整功能的音乐播放器应用

* 模块化、可维护的代码结构

* 良好的用户体验

* 稳定的性能表现

## 执行顺序说明

按照从底层到上层的顺序执行，确保每个模块都有其依赖的模块已经实现。先实现核心功能，再实现高级功能，最后进行整合和优化。
